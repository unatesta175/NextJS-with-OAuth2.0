# CRUSH.md

## Commands
npm run build      # Next.js build
npm run lint       # ESLint checks
npm run typecheck  # TypeScript analysis
npm test           # Run all Jest tests
npm test -- path/to/file.tsx  # Single test

## Code Style
- 2-space indentation (no tabs)
- No semicolons
- Single quotes for strings
- camelCase for variables
- PascalCase for components
- Imports: relative paths only (-/+ components)
- Redux slices in /features
- API calls via lib/axios.ts
- Error handling with try/catch blocks
- Types in separate types.ts files
- No console statements in production code

## Conventions
- Page components: app/[role]/[section]/page.tsx
- UI components in /components/ui
- All state updates via Redux
- Use RTK Query for async data
- Responsive styles via Tailwind

Keep this file updated as conventions evolve.

You are an expert full-stack developer. Build a full-stack Spa & Salon Booking System called Kapas Beauty Spa with the following stack and requirements.

ðŸ”¹ Tech Stack

Backend: Laravel REST API with Sanctum for authentication

Frontend: React.js + Next.js (App Router)

UI Components: Shadcn UI

State Management: Redux Toolkit + TanStack Query (React Query)

Forms: React Hook Form + Zod for validation

HTTP Client: Axios

Database: MySQL (with migrations & seeders)

Authentication & Authorization: Multi-role system (Admin, Therapist, Client)

Multi-branch support (each branch has its own staff and bookings)

Payment Gateway: Toyyibpay with

'userSecretKey' => 'm8zfj65c-2fzo-gq3b-rwhw-xvneusqy7wuy',
'categoryCode' => '2n8qqo61'

ðŸ”¹ Models & Relationships

User (multi-role: Admin, Therapist, Client)

Branch (one branch has many staff and services)

ServiceCategory (name, description)

Service (linked to ServiceCategory, branch, and therapist availability)

Booking (linked to Client, Therapist, Service, Branch, and payment)

Payment (linked to Booking, status, method)

Review (linked to Booking and Therapist)

ðŸ”¹ System Features / Use Cases
1. Authentication & Multi-role Access

Client, Therapist, Admin registration & login via Sanctum JWT.

Role-based dashboards with protected routes.

2. Branch Management (Admin)

Add, edit, delete branches.

Each branch has assigned staff and services.

3. Service & Category Management (Admin)

CRUD for service categories.

CRUD for services under categories.

Assign services to specific branches and therapists.

4. Staff Management (Admin)

Add, edit, delete therapist accounts.

Set working hours and availability per branch.

Assign services to therapists.

5. Booking Flow (Client)

Step-by-step: choose service â†’ select branch â†’ select date â†’ choose therapist â†’ select available timeslot â†’ confirm booking.

Hide already booked slots dynamically.

Booking lifecycle: Pending â†’ Confirmed â†’ Check-in â†’ Check-out â†’ Paid.

Client can reschedule or cancel before check-in.

6. Payment

Cash or Toyyibpay using the provided userSecretKey and categoryCode.

Payment status updates stored in database.

Auto-generate invoice after payment.

7. Calendar & Schedule

Staff dashboard: calendar view of all assigned bookings.

Admin dashboard: calendar per branch and staff.

8. Ratings & Reviews

Client can rate and review therapists after service completion.

Reviews displayed on therapist profiles.

9. Analytics & Reports (Admin)

Total bookings, revenue per branch, top services, staff performance.

Filter by date, branch, therapist, service category.

10. Notifications

Email or push notification for booking confirmation, reschedule, cancelation.

Reminder notification before appointment.

ðŸ”¹ API Endpoints (Laravel)

/api/auth/register (POST)

/api/auth/login (POST)

/api/services (CRUD, filter by branch/category/therapist)

/api/service-categories (CRUD)

/api/staff (CRUD + availability)

/api/branches (CRUD)

/api/bookings (create, update status, reschedule, cancel)

/api/payments (create, mark paid, Toyyibpay integration)

/api/reviews (create, fetch by therapist)

/api/dashboard (admin analytics)

ðŸ”¹ Frontend Pages (React + Next.js + Shadcn UI)

Landing Page (services by category, branch selection)

Auth Pages (Login, Register, Forgot Password)

Client Dashboard

Book a Service (step flow: service â†’ branch â†’ date â†’ therapist â†’ timeslot â†’ confirm)

My Bookings (reschedule, cancel, check-in, check-out, pay, invoice download)

My Reviews

Therapist Dashboard

My Schedule (calendar)

Manage Bookings (check-in, check-out, mark as paid)

View Reviews

Admin Dashboard

Manage Branches

Manage Services & Categories

Manage Staff

Manage Bookings

Reports & Analytics

ðŸ”¹ Implementation Notes

Use Redux Toolkit for app-wide state.

Use TanStack Query for server state (bookings, services, staff availability).

Use React Hook Form + Zod for forms and validation.

Use Axios with JWT interceptors for API requests.

Separate frontend and backend in project folder structure.

Seed database with sample branches, services, therapists, clients, and bookings for demo.

Make code modular, production-ready, and scalable.